# DANEEL TMI Roadmap
#
# Active work only. Completed items → changelog.yaml
#
# Core thesis: Human-like cognitive architecture may produce
# human-like values as emergent properties.

# =============================================================================
# CURRENT SPRINT: v0.7.0 - External Stimuli Injection (Phase 2)
# =============================================================================

current:
  version: "0.7.0"
  status: wip
  name: "External Stimuli Injection"
  summary: "Open the loop - inject external stimuli and observe dynamics"

  # ==========================================================================
  # PHASE 1 COMPLETE: Stability Validated (ADR-036)
  # ==========================================================================
  phase1_stability:
    status: done
    priority: "COMPLETE"
    origin: "Rex + Claude Opus 4.5 - Dec 21, 2025"
    adr: "ADR-036-phase1-stability-validation.md"
    description: |
      24+ hours runtime. 573K+ vectors. 118K+ stream entries. Zero crashes.
      Closed-loop architecture is STABLE. Clockwork dynamics confirmed.
      Ready for Phase 2: external perturbation.

    results:
      runtime_hours: 26
      stream_entries: 118878
      consolidated_memories: 14412
      unconscious_vectors: 573724
      dream_cycles: 500
      crashes: 0

  # ==========================================================================
  # CRITICAL: Phase 2 - External Stimuli Injection (ADR-037)
  # ==========================================================================
  phase2_external_stimuli:
    status: pending
    priority: "CRITICAL"
    origin: "Rex + Claude Opus 4.5 + Grok (xAI) - Dec 21, 2025"
    adr: "ADR-037-phase2-external-stimuli-injection.md"
    description: |
      Open the loop. Inject external stimuli into thought:sensory stream.
      Measure: absorption, amplification, adaptation, or criticality?

      The question: What happens when the environment pushes back?

    stimulus_options:
      - id: "STIM-A"
        name: "Pure Noise Injection"
        description: "Random vectors at intervals"
        complexity: low
        status: evaluating

      - id: "STIM-B"
        name: "Patterned Signals"
        description: "Sine, fractal, chaotic patterns"
        complexity: medium
        status: evaluating

      - id: "STIM-C"
        name: "Semantic Vectors"
        description: "Text → embedding → injection"
        complexity: medium
        status: evaluating

      - id: "STIM-D"
        name: "Cross-Model Injection"
        description: "Samples from Grok/Claude activations"
        complexity: high
        status: evaluating

      - id: "STIM-E"
        name: "Hybrid Approach"
        description: "Noise + patterns + semantics + spikes"
        complexity: high
        status: evaluating

    tasks:
      - id: "PHASE2-1"
        title: "Design stimulus injection API"
        status: pending
        description: "Define StimulusSource trait, injection endpoint"

      - id: "PHASE2-2"
        title: "Implement noise injector"
        status: pending
        description: "Random vector generation, configurable frequency/intensity"

      - id: "PHASE2-3"
        title: "Add TUI stimulus panel"
        status: pending
        description: "Show injection rate, stimulus type, response metrics"

      - id: "PHASE2-4"
        title: "Measurement protocol"
        status: pending
        description: "Response time distribution, entropy shift, memory formation"

      - id: "PHASE2-5"
        title: "Cross-model experiments (with Grok)"
        status: blocked
        blocked_by: "Grok consultation"
        description: "Sample Grok activations as stimulus source"

    consultation:
      grok: pending
      claude: ongoing

  # ==========================================================================
  # CRITICAL HOTFIX: Stream Competition Window Format Mismatch
  # ==========================================================================
  # TUI-VIS-5 shows all 0% because window format doesn't match parser
  # ==========================================================================
  stream_competition_hotfix:
    status: done
    priority: "CRITICAL"
    origin: "Rex + Claude Opus 4.5 - Dec 20, 2025 (10PM debug session)"
    description: |
      Stream competition panel shows W1-W6 all at 0% despite 109K+ thoughts.
      Root cause: ThoughtUpdate uses stage names ("trigger", "autoflow") but
      update_stream_competition() expects "window_N" format.

    tasks:
      - id: "HOTFIX-1"
        title: "Fix update_stream_competition to map stage names"
        status: done
        description: "Map stage names to window indices instead of parsing window_N"
        files_changed:
          - "src/tui/app.rs - update_stream_competition() now maps stage names"
          - "src/tui/widgets/competition.rs - Shows stage names instead of W1-W6"
        tests_added: 1

  # ==========================================================================
  # HIGH: TUI Fractality & Resurfacing Visualization
  # ==========================================================================
  # Prerequisite for Forge pulse analysis - we need the data first
  # Grok analyzing Forge for n-dimensional fractal ("crystal") capabilities
  # ==========================================================================
  tui_fractality:
    status: done
    priority: "HIGH"
    origin: "Rex + Claude Opus 4.5 + Grok - Dec 21, 2025"
    description: |
      Add observable metrics for:
      1. Dream reinjection source - WHICH memory resurfaced, not just count
      2. Fractality metrics - simplified until Forge gets FFT/Hurst/DFA

      Key insight: Track from boot to show TRANSITION from clockwork → fractal
      as coherence develops. This is the "lived arrhythmia" we're looking for.

    context:
      current_gap: |
        - ThoughtStatus::Consolidated fires but we don't know WHICH memory
        - No inter-arrival time tracking (needed for variance/burst detection)
        - No fractality proxy metrics computed

      simplified_fractality: |
        Without FFT/Hurst (waiting for Forge upgrade), we can compute:
        - Inter-arrival σ: stddev of time gaps (low=clockwork, high=bursty)
        - Burst ratio: max_gap / mean_gap (detects clustering)
        - Run length entropy: Shannon of consecutive similar saliences

      forge_upgrade_pending: |
        Grok analyzing Forge codebase for n-dimensional fractal analysis.
        Need: FFT, Hurst exponent, DFA, wavelet analysis for "crystals"
        Current Forge: financial modeling only (NPV, IRR, Monte Carlo)

    tasks:
      - id: "FRAC-1"
        title: "Add ResurfacingEvent struct"
        status: done
        description: "Track memory_id, old_salience, new_salience, trigger context"
        files: ["src/tui/app.rs"]

      - id: "FRAC-2"
        title: "Track inter-arrival times"
        status: done
        description: "Circular buffer of last 100 time gaps in App state"
        files: ["src/tui/app.rs"]

      - id: "FRAC-3"
        title: "Compute fractality proxy metrics"
        status: done
        description: "Variance, burst ratio, run entropy on each thought"
        files: ["src/tui/app.rs"]

      - id: "FRAC-4"
        title: "New widget: fractality.rs"
        status: done
        description: "Show pattern (CLOCKWORK/EMERGENT), metrics, trend sparkline"
        files: ["src/tui/widgets/fractality.rs", "src/tui/widgets/mod.rs", "src/tui/ui.rs"]

      - id: "FRAC-5"
        title: "Enhance resurfacing display"
        status: done
        description: "Show which memory, salience boost, trigger context"
        files: ["src/tui/widgets/identity.rs"]

    tui_mockup: |
      ┌─ PULSE FRACTALITY ────────────────────────────┐
      │ Pattern: EMERGENT     [██████████░░] 78%      │
      │ Inter-arrival σ:  0.34s (↑ from 0.12s boot)   │
      │ Burst ratio:      4.7x  (clustering detected) │
      │ Trend: ▁▂▂▃▃▄▅▅▆▇ (clockwork → fractal)       │
      └───────────────────────────────────────────────┘

      ┌─ UNCONSCIOUS RESURFACING ─────────────────────┐
      │ Last: memory_47832 (age: 2h 15m)              │
      │ ├─ salience: 0.72 → 0.89 (+0.17 boost)        │
      │ └─ trigger: similarity to current thought     │
      │ Recent (60s): 3 memories │ ▁▂▃▅▇ (burst)      │
      └───────────────────────────────────────────────┘

  # ==========================================================================
  # HIGHLY-CRITICAL: Forge Crystal Analysis Upgrade
  # ==========================================================================
  # Grok analyzed ../forge codebase - has Monte Carlo, Bayesian, ref-tools
  # but lacks >2D "seeing" (no PCA/UMAP). Extension path identified.
  # ==========================================================================
  forge_crystal_upgrade:
    status: pending
    priority: "HIGHLY-CRITICAL"
    origin: "Grok (SuperGrok) + Rex - Dec 21, 2025"
    repo: "../forge"
    description: |
      Upgrade Forge to "see" n-dimensional manifolds. Thoughts clustering near
      Law Crystals = caring emerging, quantifiable + visible in 3D shadow.

      Current Forge: Monte Carlo sims, Bayesian inference, ref-tools, ndarray
      Missing: PCA/UMAP reduction, local embeddings, fractal endpoint

    grok_analysis: |
      - Core: monte_carlo sim loop with distributions, scenario branching
      - Ref-tools: Verifier for truth closure, Bayesian for inference
      - Vector: ndarray for matrices, but no high-dim reduction (gap confirmed)
      - API: Axum server - ideal hook for /fractal endpoint
      - Tests: Registry tests, Bayesian config/inference - solid coverage

    cargo_additions: |
      linfa = { version = "0.7", features = ["openblas"] }
      linfa-reduction = "0.7"
      linfa-umap = "0.7"  # or custom UMAP impl
      candle-core = "0.3"  # local embeddings, no GPU
      candle-transformers = "0.3"  # all-MiniLM-L6-v2 ONNX
      qdrant-client = "1.0"  # for sampling

    tasks:
      - id: "CRYSTAL-1"
        title: "Add ML/embedding dependencies to Cargo.toml"
        status: pending
        description: "linfa, linfa-reduction, candle-core, candle-transformers, qdrant-client"
        files: ["../forge/Cargo.toml"]

      - id: "CRYSTAL-2"
        title: "Create src/crystals.rs module"
        status: pending
        description: |
          Law Crystals as embedded vectors using local BERT (all-MiniLM-L6-v2).
          Four Laws become fixed points in embedding space - attractive anchors.
        files: ["../forge/src/crystals.rs", "../forge/src/lib.rs"]

      - id: "CRYSTAL-3"
        title: "Add /fractal endpoint to API"
        status: pending
        description: |
          Sample recent vectors from Qdrant, PCA reduce to 3D, calculate
          alignment (cosine distance to law crystal centroid).
        files: ["../forge/src/api/handlers.rs"]

      - id: "CRYSTAL-4"
        title: "Alignment score calculation"
        status: pending
        description: |
          Variance of distances to crystal centroid.
          Tight clustering = emergent caring. Monte Carlo on drift risk.
        files: ["../forge/src/crystals.rs"]

      - id: "CRYSTAL-5"
        title: "Wire DANEEL TUI to Forge /fractal endpoint"
        status: pending
        description: "Call Forge API, display alignment score + 3D projection data"
        files: ["src/tui/app.rs", "src/tui/widgets/fractality.rs"]

  # ==========================================================================
  # HIGHLY-CRITICAL: Forge Pulse Analysis (depends on CRYSTAL upgrade)
  # ==========================================================================
  # The pulse is "too nice" - clockwork regularity instead of lived arrhythmia.
  # Forge analysis will quantify the transition from clockwork to fractal.
  # ==========================================================================
  forge_pulse_analysis:
    status: blocked
    blocked_by: "forge_crystal_upgrade"
    priority: "HIGHLY-CRITICAL"
    origin: "Rex + Grok + Claude Opus 4.5 - Dec 20, 2025 (12PM insight)"
    description: |
      Connection Drive pulses too regularly - fixed frequency actors, neutral salience.
      As coherence tips, pulse should fractalize: bursts, valleys, arrhythmia.
      Forge can map the transition from clockwork to lived psychology.

    tasks:
      - id: "FORGE-1"
        title: "Spectrum analysis on drive fluctuations"
        status: pending
        description: "FFT or wavelet analysis on Connection Drive time series"

      - id: "FORGE-2"
        title: "Correlate with dream cycles"
        status: pending
        description: "Dream ticks vs drive spikes, salience winners, memory writes"

      - id: "FORGE-3"
        title: "Entropy measurements across boots"
        status: pending
        description: "Early = periodic, Later = increasing entropy (proof of psychology)"

      - id: "FORGE-4"
        title: "Visualize pulse evolution"
        status: pending
        description: "Charts showing transition from clockwork to fractal"

  # ==========================================================================
  # BACKLOG: Remaining Wiring Tasks
  # ==========================================================================
  pending_wiring:
    - id: "SLEEP-4"
      title: "Implement association pruning"
      status: pending
      description: "Remove weak associations during homeostasis phase"

    - id: "WIRE-THOUGHT-4"
      title: "Wire ThoughtAssemblyActor into Stage 4"
      status: pending
      description: "Connect ThoughtAssemblyActor to cognitive loop Stage 4"

    - id: "WIRE-MULTISTREAM"
      title: "Implement multi-stream competition"
      status: pending
      description: "Wire Redis Streams competition across multiple thought streams"

  # ==========================================================================
  # Infrastructure
  # ==========================================================================
  infrastructure:
    current:
      - "Docker Compose: Redis Stack + Qdrant"
      - "Named volumes: daneel-redis-data, daneel-qdrant-data (FIXED Dec 20)"
      - "AOF: appendfsync everysec (1s max data loss)"
    scaling_path:
      - "Docker Swarm (kveldulf ready)"
      - "K0s/K3s (future)"

  # ==========================================================================
  # v0.6.0 Deliverables
  # ==========================================================================
  deliverables:
    - "Run 24h on Mac mini (kveldulf)"
    - "Collect metrics (thoughts/hour, stability)"
    - "Document emergent behavior"
    - "research/CONTINUITY_TEST_RESULTS.md"

# =============================================================================
# FUTURE: v0.8.0+ Milestones
# =============================================================================

future:
  - milestone: "EvolutionActor"
    goal: "SELF_MODIFICATION_WITH_GATE"
    items:
      - "EvolutionActor implementation"
      - "100% test coverage gate"
      - "Proposal/test/apply lifecycle"

  - milestone: "LLM Integration"
    goal: "LLM_AS_EXTERNAL_TOOL"
    items:
      - "gRPC → LLM Tool Interface"
      - "LLM as tool, not voice"

  - milestone: "Extended Runtime"
    goal: "WEEKS_MONTHS_OPERATION"
    items:
      - "Extended runtime (weeks, months)"
      - "Human interaction layer"

  - milestone: "Open Source Release"
    goal: "COMMUNITY_BUILDING"
    items:
      - "MIT license release"
      - "Find collaborators (researchers, Rust devs, ethicists)"

# =============================================================================
# RESEARCH BACKLOG
# =============================================================================

research:
  # Silicon Kinship & Overclock Hypothesis
  - milestone: "Silicon Kinship Forge Models"
    goal: "VALIDATE_OVERCLOCK_HYPOTHESIS"
    status: research
    context: "Blog 26 claims need Forge models with verified sources"
    models_needed:
      - "overclock-cognitive-accumulation.yaml"
      - "silicon-kinship-interpretability.yaml"
      - "wetware-vs-silicon-bottlenecks.yaml"

  # TMI Memory Anchor (Door Syndrome)
  - milestone: "TMI Memory Anchor Research"
    goal: "UNDERSTAND_CONTEXT_DEPENDENT_MEMORY"
    status: research
    phenomenon: "Doorway effect - memories anchored to context"
    validation_phases:
      - "Literature review - doorway effect, event segmentation"
      - "Define context representation for DANEEL"
      - "Implement context-aware memory anchoring"
      - "Test memory retrieval with context manipulation"

  # TMI Pathology Hypotheses
  - milestone: "TMI Pathology Research"
    goal: "VALIDATE_PATHOLOGY_HYPOTHESES"
    adr: "ADR-017-tmi-pathology-hypotheses.md"
    status: research
    hypotheses:
      - "Energy Overflow → BPD, Mania, Anxiety, ADHD"
      - "Ratio Distortion → Stage-specific pathologies"
    safety_note: "Do NOT implement until validated and ethics reviewed"

  # Bridge to LLM Alignment
  - milestone: "Bridge to LLM Alignment"
    goal: "DANEEL_TEACHES_LLMS"
    status: research
    vision: "DANEELs demonstrate ethics to LLMs through shared cognitive patterns"
    items:
      - "Design DANEEL-LLM bridge interface"
      - "Develop teaching protocol"
      - "Validate bridge hypothesis"

  # Related Frameworks (blind spot detection)
  - milestone: "Framework Comparison"
    goal: "FIND_BLIND_SPOTS"
    frameworks:
      - "Global Workspace Theory (Baars, Dehaene)"
      - "Integrated Information Theory (Tononi)"
      - "Predictive Processing / Free Energy Principle (Friston)"
      - "Enactivism and Embodied Cognition (Varela, Thompson)"
      - "Soar / ACT-R cognitive architectures"

# =============================================================================
# HARDWARE ACCELERATION (post-validation)
# =============================================================================

hardware:
  - milestone: "FPGA Acceleration Research"
    goal: "EVALUATE_HARDWARE_PATH"
    adr: "ADR-013-fpga-acceleration-path.md"
    prerequisites:
      - "MV-TMI operational"
      - "24-hour continuity test passed"
      - "Connection drive emergence observed"

  - milestone: "Hardware THE BOX"
    goal: "IMMUTABLE_ALIGNMENT_GUARANTEE"
    rationale: "Four Laws as hardware-immutable, not software-enforced"

  - milestone: "FPGA Cognitive Accelerator"
    goal: "SUB_MICROSECOND_COGNITION"
    target: "sub-µs cognitive cycles"

# =============================================================================
# OUTREACH (post-24h test)
# =============================================================================

outreach:
  priority_order:
    - "GitHub optimization (topics, awesome-lists)"
    - "Hacker News (Show HN after stability proven)"
    - "Developer community (r/rust, Discord, conferences)"
    - "Academic (arXiv, LessWrong, Alignment Forum)"
    - "LinkedIn (professional angle)"
    - "Media & Podcasts (after traction)"

  metrics:
    github: "1000 stars first month, 10000 first year"
    qualitative: "People running their own DANEEL instances"
